import React, { useState, useCallback } from 'react';

// Componente para a página principal do Link na Bio
// Usamos React.memo para evitar re-renderizações desnecessárias se as props não mudarem.
const LinkBioPage = React.memo(({ onMathClick, onGamesClick }) => {
  return (
    <div className="min-h-screen bg-gray-900 text-white flex flex-col items-center justify-center p-4 font-sans"
         style={{ backgroundImage: 'url(uploaded:Site para Link na Bio Tecnologia e Jogos Escuro Simples Azul-escuro.jpg-cd7aeb54-f7a3-49fe-8dbd-ff32ef9c99e1)', backgroundSize: 'cover', backgroundPosition: 'center' }}>
      
      {/* Título Principal */}
      <div className="text-center mb-10">
        <h1 className="text-4xl md:text-5xl font-bold text-blue-300 mb-2 font-['Inter']" style={{ fontFamily: 'cursive' }}>
          Língua Portuguesa e Tecnologia
        </h1>
        {/* Fonte do PROF.º MARLON COSTA - Diminuída um pouco */}
        <h2 className="text-xl md:text-2xl text-gray-300 font-bold font-['Inter']">
          PROF.º MARLON COSTA
        </h2>
      </div>

      {/* Container principal dos links com bordas arredondadas e opacidade revertida */}
      <div className="bg-white bg-opacity-10 backdrop-filter backdrop-blur-lg p-8 md:p-12 rounded-3xl shadow-lg border border-gray-700 w-full max-w-2xl">
        <div className="grid grid-cols-2 md:grid-cols-3 gap-6">
          {/* Item: Conexões Matemáticas */}
          <a href="#" onClick={onMathClick} className="flex flex-col items-center justify-center p-4 bg-gray-800 rounded-lg hover:bg-gray-700 transition duration-300 ease-in-out transform hover:scale-105">
            <svg className="w-10 h-10 text-blue-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 4v16m8-8H4m12 0H8m-4 0h16"></path>
            </svg>
            <span className="text-sm text-center">Conexões Matemáticas</span>
          </a>

          {/* Item: Jogos - Agora com onClick para abrir o popup de seleção de jogos */}
          <a href="#" onClick={onGamesClick} className="flex flex-col items-center justify-center p-4 bg-gray-800 rounded-lg hover:bg-gray-700 transition duration-300 ease-in-out transform hover:scale-105">
            <svg className="w-10 h-10 text-blue-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M11 4v1m0 10v1m-4-7h1m10 0h1M17 4h2a2 2 0 012 2v10a2 2 0 01-2 2h-2M5 4H3a2 2 0 00-2 2v10a2 2 0 002 2h2m0 0h14m-14 0l-2 2m2-2l2 2m7-2h-4m-7 0H7m0 0l-2 2m2-2l-2 2"></path>
            </svg>
            <span className="text-sm text-center">Jogos</span>
          </a>

          {/* Item: Gramatiquês - Ícone alterado para um "G" estilizado */}
          <a href="#" className="flex flex-col items-center justify-center p-4 bg-gray-800 rounded-lg hover:bg-gray-700 transition duration-300 ease-in-out transform hover:scale-105">
            <svg className="w-10 h-10 text-blue-400 mb-2" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              {/* Path para a letra G */}
              <path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8zm-1-13v2h2v-2h-2zm0 4v2h2v-2h-2zm0 4v2h2v-2h-2zM15 9h-2v2h2v-2zm0 4h-2v2h2v-2zm0 4h-2v2h2v-2zM9 9H7v2h2V9zm0 4H7v2h2v-2zm0 4H7v2h2v-2zM12 5a7 7 0 100 14 7 7 0 000-14zM12 7c-2.761 0-5 2.239-5 5s2.239 5 5 5 5-2.239 5-5-2.239-5-5-5zm0 2h1.5a.5.5 0 010 1h-1.5v-1zm0 2h1.5a.5.5 0 010 1h-1.5v-1zm0 2h1.5a.5.5 0 010 1h-1.5v-1zM12 15h1.5a.5.5 0 010 1h-1.5v-1z"/>
            </svg>
            <span className="text-sm text-center">Gramatiquês</span>
          </a>

          {/* Item: Armazenamento */}
          <a href="#" className="flex flex-col items-center justify-center p-4 bg-gray-800 rounded-lg hover:bg-gray-700 transition duration-300 ease-in-out transform hover:scale-105">
            <svg className="w-10 h-10 text-blue-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 00-9.899 0z"></path>
            </svg>
            <span className="text-sm text-center">Armazenamento</span>
          </a>

          {/* Item: Exercícios */}
          <a href="#" className="flex flex-col items-center justify-center p-4 bg-gray-800 rounded-lg hover:bg-gray-700 transition duration-300 ease-in-out transform hover:scale-105">
            <svg className="w-10 h-10 text-blue-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.523 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5s3.332.477 4.5 1.253v13C19.832 18.523 18.246 18 16.5 18s-3.332.477-4.5 1.253"></path>
            </svg>
            <span className="text-sm text-center">Exercícios</span>
          </a>

          {/* Item: Vídeos */}
          <a href="#" className="flex flex-col items-center justify-center p-4 bg-gray-800 rounded-lg hover:bg-gray-700 transition duration-300 ease-in-out transform hover:scale-105">
            <svg className="w-10 h-10 text-blue-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M4 5a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2H4z"></path>
            </svg>
            <span className="text-sm text-center">Vídeos</span>
          </a>
        </div>
      </div>

      {/* Ícones de Redes Sociais */}
      <div className="flex space-x-6 mt-10">
        <a href="#" className="text-gray-400 hover:text-white transition duration-300">
          <svg className="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path fillRule="evenodd" d="M12.315 2c2.43 0 2.784.002 3.797.048.843.04 1.48.153 2.01.356.678.257 1.173.64 1.64.203.53.316 1.167.356 2.01-.046 1.013-.048 1.367-.048 3.797s.002 2.784-.048 3.797c-.04.843-.153 1.48-.356 2.01-.257.678-.64 1.173-1.107 1.64-.467.467-.85-.962-1.107-1.64-.203-.53-.316-1.167-.356-2.01-.046 1.013-.048 1.367-.048 3.797s.002 2.784.048-3.797c.04-.843.153-1.48.356-2.01.257-.678.64-1.173 1.107-1.64.467-.467.962-.85 1.64-1.107.53-.203 1.167.316 2.01-.356C9.516 2.002 9.87 2 12.315 2zm0 2.166c-2.42 0-2.753.001-3.792.048-.85.04-1.348.145-1.679.26-.403.14-.683.319-.92.559-.239.24-.418.52-.559.92-.115.331-.22.829-.26 1.679-.047 1.039-.048 1.372-.048 3.792s.001 2.753.048 3.792c.04.85.145 1.348.26 1.679.14.403.319.683.559.92.24.239.52.418.92.559.331.115.829.22 1.679.26 1.039.047 1.372.048 3.792.048s2.753-.001 3.792-.048c.85-.04 1.348-.145 1.679-.26.403-.14.683-.319.92-.559.239-.24-.418-.52-.559-.92-.115-.331-.22-.829-.26-1.679.047-1.039.048-1.372.048-3.792s-.001-2.753-.048-3.792c-.04-.85-.145-1.348-.26-1.679-.14-.403-.319-.683-.559-.92-.239-.24-.52-.418-.92-.559-.331-.115-.829-.22-1.679-.26-1.039-.047-1.372-.048-3.792-.048zM12 9.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5z" clipRule="evenodd" />
          </svg>
        </a>
        <a href="#" className="text-gray-400 hover:text-white transition duration-300">
          <svg className="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.776-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33V22H12c5.523 0 10-4.477 10-10z" />
          </svg>
        </a>
        {/* Ícone do YouTube adicionado */}
        <a href="#" className="text-gray-400 hover:text-white transition duration-300">
          <svg className="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path fillRule="evenodd" d="M19.812 5.405c.774.212 1.393.831 1.605 1.605C21.61 8.417 22 12 22 12s0 3.583-.583 4.995c-.212.774-.831 1.393-1.605 1.605C18.583 19 12 19 12 19s-6.583 0-7.995-.583c-.774-.212-1.393-.831-1.605-1.605C2 15.583 2 12 2 12s0-3.583.583-4.995c.212-.774.831-1.393 1.605-1.605C5.417 5 12 5 12 5s6.583 0 7.812.405zM10 15.5l6-3.5-6-3.5v7z" clipRule="evenodd" />
          </svg>
        </a>
      </div>
    </div>
  );
});

// Componente para o popup de seleção de jogos
// Usamos React.memo para evitar re-renderizações desnecessárias se as props não mudarem.
const GameSelectionPopup = React.memo(({ onSelectGame, onClose }) => {
  return (
    <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
      <div className="bg-gray-800 p-8 rounded-lg shadow-xl border border-blue-600 max-w-md w-full text-center">
        <h2 className="text-3xl font-bold text-blue-300 mb-6">Escolha um Jogo</h2>
        <div className="flex flex-col space-y-4">
          <button
            onClick={() => onSelectGame('memoryGame')}
            className="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 shadow-md flex items-center justify-center"
          >
            {/* Ícone de livro (SVG) */}
            <svg className="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M2 6h4v14H2zm6 0h14v14H8zm12-4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 4h12v2H8V4zm0 4h12v2H8V8zm0 4h12v2H8v-2zm0 4h12v2H8v-2z"/>
            </svg>
            Jogo da Memória Gramatical
          </button>
          {/* Futuros jogos podem ser adicionados aqui */}
          <button
            onClick={onClose}
            className="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 shadow-md mt-4"
          >
            Voltar
          </button>
        </div>
      </div>
    </div>
  );
});

// Componente para o Jogo da Memória (renderiza o HTML via iframe)
function MemoryGamePage({ onBackClick }) {
  // O conteúdo HTML completo do jogo será inserido aqui.
  // A string foi dividida para melhorar a legibilidade e evitar problemas de compilação com strings muito longas.
  const memoryGameHtmlContent = `
    <!DOCTYPE html>
    <html lang="pt-BR">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Jogo da Memória - Mestres em Gramática</title>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
        <!-- Inclui o CDN do Tailwind CSS para garantir que os estilos sejam aplicados dentro do iframe -->
        <script src="https://cdn.tailwindcss.com"></script>
        <style>
            /* Estilos para a caixa de mensagem personalizada (modais genéricos) */
            .message-box {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #1a2b3c; /* Fundo da caixa de mensagem */
                padding: 2rem;
                border-radius: 0.75rem; /* rounded-lg */
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.15); /* Sombra mais escura */
                z-index: 1000;
                text-align: center;
                max-width: 90%;
                border: 1px solid #3b82f6; /* Borda azul */
                color: #e0e7ff; /* Texto claro */
                display: none; /* Escondido por padrão, controlado via JS */
            }
            .message-box-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.7); /* Fundo semi-transparente mais escuro */
                z-index: 999;
                display: none; /* Escondido por padrão, controlado via JS */
            }
            .message-box button {
                background-color: #3b82f6; /* Tailwind blue-500 */
                color: white;
                padding: 0.5rem 1rem;
                border-radius: 0.5rem;
                font-weight: bold;
                cursor: pointer;
                transition: background-color 0.2s ease-in-out;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
                margin-top: 1rem;
            }
            .message-box button:hover {
                background-color: #2563eb; /* Tailwind blue-600 */
            }

            /* Estilos globais e reset */
            body {
                font-family: 'Inter', sans-serif;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                background: linear-gradient(135deg, #3a1c71, #d76d77, #ffaf7b); /* Gradiente vibrante */
                color: #ecf0f1;
                margin: 0;
                padding: 20px;
                box-sizing: border-box;
                overflow-x: hidden;
            }

            .container {
                background-color: rgba(0, 0, 0, 0.6); /* Fundo semi-transparente */
                border-radius: 20px;
                box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5);
                padding: 40px;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 25px;
                max-width: 900px;
                width: 100%;
                box-sizing: border-box;
                backdrop-filter: blur(5px); /* Efeito de desfoque */
                -webkit-backdrop-filter: blur(5px); /* Compatibilidade Safari */
            }

            h1 {
                color: #ffaf7b; /* Cor de destaque */
                margin-bottom: 10px;
                font-size: 3em;
                text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.4);
                text-align: center;
                letter-spacing: 1px;
            }

            /* Estilos para as telas do jogo */
            .game-screen, .start-screen, .results-screen {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 20px;
                width: 100%;
            }

            .start-screen input, .start-screen select {
                width: 80%;
                max-width: 300px;
                padding: 12px;
                border-radius: 8px;
                border: 1px solid #d76d77;
                background-color: rgba(255, 255, 255, 0.9);
                color: #333;
                font-size: 1.1em;
                box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
            }

            .start-screen label {
                font-size: 1.2em;
                font-weight: bold;
                color: #ecf0f1;
                margin-bottom: 5px;
                text-align: left;
                width: 80%;
                max-width: 300px;
            }

            .game-info {
                display: flex;
                justify-content: space-around;
                width: 100%;
                max-width: 600px; /* Aumentado para acomodar o cronômetro */
                font-size: 1.3em;
                font-weight: bold;
                color: #d76d77;
                background-color: rgba(255, 255, 255, 0.1);
                padding: 10px 20px;
                border-radius: 10px;
                box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
            }

            .board {
                display: grid;
                grid-template-columns: repeat(4, 1fr); /* 4 colunas */
                grid-template-rows: repeat(6, 1fr); /* 6 linhas para 24 cartas */
                gap: 15px;
                width: 600px; /* Tamanho fixo para o tabuleiro */
                height: 900px; /* Ajustado para acomodar mais linhas (600px / 4 * 6 = 900px) */
                perspective: 1000px; /* Para o efeito 3D de virar a carta */
            }

            .card-container {
                width: 100%;
                height: 100%;
                position: relative;
                transform-style: preserve-3d;
                transition: transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1); /* Curva de animação mais suave */
                cursor: pointer;
                border-radius: 12px;
                box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
            }

            .card-container.flipped {
                transform: rotateY(180deg);
            }

            .card-front, .card-back {
                width: 100%;
                height: 100%;
                position: absolute;
                backface-visibility: hidden;
                border-radius: 12px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.4em; /* Tamanho do texto ajustado para gramática */
                font-weight: bold;
                color: #333;
                text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
                box-sizing: border-box;
                padding: 5px; /* Adiciona um pouco de padding para o texto */
                text-align: center;
                line-height: 1.2; /* Ajusta a altura da linha para evitar corte */
                overflow: hidden; /* Garante que o texto não vaze */
                text-overflow: ellipsis; /* Adiciona reticências se o texto for muito longo */
            }

            .card-back {
                background: linear-gradient(145deg, #6a11cb, #2575fc); /* Fundo da carta virada */
                transform: rotateY(0deg);
                border: 3px solid #ffaf7b; /* Borda de destaque */
                box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.4);
            }

            .card-front {
                background-color: #ecf0f1; /* Fundo da carta revelada */
                transform: rotateY(180deg);
                border: 3px solid #d76d77;
                box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.2);
            }

            .card-container.matched .card-front {
                background-color: #2ecc71; /* Verde para cartas combinadas */
                opacity: 0.8;
                pointer-events: none; /* Desabilita clique em cartas combinadas */
            }

            .card-container.disabled {
                pointer-events: none; /* Desabilita clique durante a animação de virar */
            }

            .button {
                background: linear-gradient(45deg, #ffaf7b, #d76d77); /* Gradiente para o botão */
                color: white;
                border: none;
                padding: 15px 30px;
                border-radius: 10px;
                font-size: 1.2em;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
                text-transform: uppercase;
                letter-spacing: 1.5px;
                font-weight: bold;
                margin-top: 20px;
            }

            .button:hover {
                transform: translateY(-3px) scale(1.02);
                box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
                filter: brightness(1.1);
            }

            .button:active {
                transform: translateY(0);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }

            .results-screen p {
                font-size: 1.5em;
                margin: 10px 0;
                color: #ecf0f1;
                text-align: center;
            }

            .results-screen p strong {
                color: #ffaf7b;
            }

            /* Responsividade */
            @media (max-width: 768px) {
                .container {
                    padding: 25px;
                    gap: 15px;
                }

                h1 {
                    font-size: 2.2em;
                }

                .game-info {
                    font-size: 1.1em;
                    padding: 8px 15px;
                    flex-wrap: wrap; /* Permite que os itens quebrem a linha */
                    justify-content: center;
                    gap: 10px;
                }

                .board {
                    width: 350px;
                    height: 525px; /* 350px / 4 * 6 = 525px */
                    gap: 10px;
                }

                .card-front, .card-back {
                    font-size: 1.1em; /* Ajusta o tamanho da fonte para telas menores */
                }

                .button {
                    padding: 12px 25px;
                    font-size: 1em;
                }

                .start-screen input, .start-screen select {
                    width: 90%;
                }
            }

            @media (max-width: 480px) {
                .container {
                    padding: 15px;
                }

                h1 {
                    font-size: 1.8em;
                }

                .game-info {
                    flex-direction: column;
                    gap: 5px;
                    text-align: center;
                }

                .board {
                    width: 280px;
                    height: 420px; /* 280px / 4 * 6 = 420px */
                    gap: 8px;
                }

                .card-front, .card-back {
                    font-size: 0.9em; /* Ajusta o tamanho da fonte para telas muito pequenas */
                }
            }
        </style>
    </head>
    <body>
        <div class="message-box-overlay" id="generic-message-box-overlay"></div>
        <div class="message-box" id="generic-message-box">
            <p id="generic-message-box-text" class="text-lg font-semibold mb-4"></p>
            <button id="generic-message-box-close-btn" class="action-button">OK</button>
        </div>

        <div class="container">
            <h1>Jogo da Memória - Mestres em Gramática</h1>

            <!-- Tela de Início -->
            <div id="startScreen" class="start-screen">
                <label for="studentNameInput">Nome do Aluno:</label>
                <input type="text" id="studentNameInput" placeholder="DIGITE SEU NOME" required>

                <label for="classSelect">Turma:</label>
                <select id="classSelect" required>
                    <option value="">Selecione a turma</option>
                    <option value="7º 01">7º 01</option>
                    <option value="8º 01">8º 01</option>
                    <option value="8º 02">8º 02</option>
                </select>

                <button id="startGameButton" class="button">Iniciar Jogo</button>
            </div>

            <!-- Tela do Jogo -->
            <div id="gameScreen" class="game-screen" style="display: none;">
                <div class="game-info">
                    <span>Movimentos: <span id="moves">0</span></span>
                    <span>Pares Encontrados: <span id="matches">0</span> / <span id="totalPairs">12</span></span>
                    <span>Tempo: <span id="timer">00:00</span></span>
                </div>
                <div id="gameBoard" class="board"></div>
                <button id="resetButton" class="button">Reiniciar Jogo</button>
            </div>

            <!-- Tela de Resultados -->
            <div id="resultsScreen" class="results-screen" style="display: none;">
                <h2>Parabéns!</h2>
                <p>Aluno: <strong id="finalStudentName"></strong></p>
                <p>Turma: <strong id="finalClass"></strong></p>
                <p>Tempo: <strong id="finalTime"></strong></p>
                <p>Movimentos: <strong id="finalMoves"></strong></p>
                <button id="playAgainButton" class="button">Jogar Novamente</button>
            </div>
        </div>

        <script>
            // Funções para a caixa de mensagem personalizada
            function showMessageBox(message) {
                document.getElementById('generic-message-box-text').textContent = message;
                document.getElementById('generic-message-box').style.display = 'block';
                document.getElementById('generic-message-box-overlay').style.display = 'block';
            }

            function hideMessageBox() {
                document.getElementById('generic-message-box').style.display = 'none';
                document.getElementById('generic-message-box-overlay').style.display = 'none';
            }

            document.getElementById('generic-message-box-close-btn').addEventListener('click', hideMessageBox);
            document.getElementById('generic-message-box-overlay').addEventListener('click', hideMessageBox);


            // Variáveis globais para os elementos do DOM
            const startScreen = document.getElementById('startScreen');
            const studentNameInput = document.getElementById('studentNameInput');
            const classSelect = document.getElementById('classSelect');
            const startGameButton = document.getElementById('startGameButton');

            const gameScreen = document.getElementById('gameScreen');
            const gameBoard = document.getElementById('gameBoard');
            const movesDisplay = document.getElementById('moves');
            const matchesDisplay = document.getElementById('matches');
            const totalPairsDisplay = document.getElementById('totalPairs');
            const timerDisplay = document.getElementById('timer');
            const resetButton = document.getElementById('resetButton');

            const resultsScreen = document.getElementById('resultsScreen');
            const finalStudentName = document.getElementById('finalStudentName');
            const finalClass = document.getElementById('finalClass');
            const finalTime = document.getElementById('finalTime');
            const finalMoves = document.getElementById('finalMoves');
            const playAgainButton = document.getElementById('playAgainButton');


            // Banco de dados grande de pares de palavras e suas classificações gramaticais
            const allGrammarPairs = [
                { word: 'Correu', category: 'Verbo' },
                { word: 'Casa', category: 'Substantivo' },
                { word: 'Bonito', category: 'Adjetivo' },
                { word: 'Rapidamente', category: 'Advérbio' },
                { word: 'E', category: 'Conjunção' },
                { word: 'Em', category: 'Preposição' },
                { word: 'Eu', category: 'Pronome' },
                { word: 'Um', category: 'Artigo' },
                { word: 'Sempre', category: 'Advérbio' },
                { word: 'Flor', category: 'Substantivo' },
                { word: 'Grande', category: 'Adjetivo' },
                { word: 'Mas', category: 'Conjunção' },
                { word: 'Ontem', category: 'Advérbio' },
                { word: 'Mesa', category: 'Substantivo' },
                { word: 'Inteligente', category: 'Adjetivo' },
                { word: 'Com', category: 'Preposição' },
                { word: 'Nós', category: 'Pronome' },
                { word: 'Aquele', category: 'Pronome' },
                { word: 'Cantar', category: 'Verbo' },
                { word: 'Felicidade', category: 'Substantivo' },
                { word: 'Triste', category: 'Adjetivo' },
                { word: 'Muito', category: 'Advérbio' },
                { word: 'Para', category: 'Preposição' },
                { word: 'Ou', category: 'Conjunção' },
                { word: 'Viver', category: 'Verbo' },
                { word: 'Criança', category: 'Substantivo' },
                { word: 'Alto', category: 'Adjetivo' },
                { word: 'Pular', category: 'Verbo' },
                { word: 'Livro', category: 'Substantivo' },
                { word: 'Devagar', category: 'Advérbio' },
                { word: 'Porque', category: 'Conjunção' },
                { word: 'Sobre', category: 'Preposição' }
            ];

            let currentGrammarPairs = []; // Pares selecionados para o jogo atual
            let cards = []; // Armazenará as cartas do jogo

            // Estado do jogo
            let flippedCards = []; // Armazena as duas cartas viradas atualmente
            let matchedPairs = 0;
            let totalMoves = 0;
            let lockBoard = false; // Impede cliques enquanto as cartas estão virando
            let timerInterval;
            let seconds = 0;
            let studentName = '';
            let studentClass = '';

            const NUM_PAIRS_PER_GAME = 12; // Número de pares a serem usados em cada jogo

            /**
             * Seleciona aleatoriamente um número de pares do banco de dados grande.
             * @returns {Array<Object>} Um array com os pares selecionados.
             */
            function selectRandomGrammarPairs() {
                const shuffled = [...allGrammarPairs].sort(() => 0.5 - Math.random());
                return shuffled.slice(0, NUM_PAIRS_PER_GAME);
            }

            /**
             * Inicializa o jogo: cria e embaralha as cartas.
             */
            function initializeGame() {
                currentGrammarPairs = selectRandomGrammarPairs(); // Seleciona novos pares
                totalPairsDisplay.textContent = currentGrammarPairs.length;

                // Cria as cartas a partir dos pares de gramática selecionados
                cards = [];
                currentGrammarPairs.forEach((pair, index) => {
                    // Substitui template literal por concatenação de strings
                    cards.push({ display: pair.word, pairId: 'pair' + index });
                    cards.push({ display: pair.category, pairId: 'pair' + index });
                });

                shuffleCards();
                renderCards();

                // Reinicia o estado do jogo
                flippedCards = [];
                matchedPairs = 0;
                totalMoves = 0;
                lockBoard = false;
                seconds = 0;
                clearInterval(timerInterval); // Garante que qualquer timer anterior seja parado
                updateDisplay();
                updateTimerDisplay(); // Reseta o display do timer
            }

            /**
             * Embaralha as cartas usando o algoritmo Fisher-Yates.
             */
            function shuffleCards() {
                for (let i = cards.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [cards[i], cards[j]] = [cards[j], cards[i]]; // Troca elementos
                }
            }

            /**
             * Renderiza as cartas no tabuleiro do DOM.
             */
            function renderCards() {
                gameBoard.innerHTML = ''; // Limpa o tabuleiro existente
                cards.forEach((card, index) => {
                    const cardContainer = document.createElement('div');
                    cardContainer.classList.add('card-container');
                    cardContainer.dataset.index = index; // Para identificar a carta
                    cardContainer.dataset.pairId = card.pairId; // Para identificar o par

                    const cardFront = document.createElement('div');
                    cardFront.classList.add('card-front');
                    cardFront.textContent = card.display; // Exibe a palavra ou categoria

                    const cardBack = document.createElement('div');
                    cardBack.classList.add('card-back');

                    cardContainer.appendChild(cardFront);
                    cardContainer.appendChild(cardBack);

                    cardContainer.addEventListener('click', flipCard);
                    gameBoard.appendChild(cardContainer);
                });
            }

            /**
             * Vira uma carta quando clicada.
             * @param {Event} event - O evento de clique.
             */
            function flipCard(event) {
                const clickedCard = event.currentTarget;

                // Impede cliques se o tabuleiro estiver bloqueado, se a carta já estiver virada ou já combinada
                if (lockBoard || clickedCard.classList.contains('flipped') || clickedCard.classList.contains('matched')) {
                    return;
                }

                clickedCard.classList.add('flipped');
                flippedCards.push(clickedCard);

                if (flippedCards.length === 2) {
                    totalMoves++;
                    updateDisplay();
                    checkForMatch();
                }
            }

            /**
             * Verifica se as duas cartas viradas são um par.
             */
            function checkForMatch() {
                lockBoard = true; // Bloqueia o tabuleiro para evitar mais cliques

                const [card1, card2] = flippedCards;
                const pairId1 = card1.dataset.pairId;
                const pairId2 = card2.dataset.pairId;

                if (pairId1 === pairId2) {
                    // É um par!
                    matchedPairs++;
                    updateDisplay();
                    disableCards();
                    if (matchedPairs === currentGrammarPairs.length) {
                        clearInterval(timerInterval); // Para o cronômetro
                        showResultsScreen();
                    }
                } else {
                    // Não é um par, vira as cartas de volta
                    setTimeout(unflipCards, 1000); // Espera um pouco antes de virar de volta
                }
            }

            /**
             * Desabilita as cartas que formam um par.
             */
            function disableCards() {
                flippedCards.forEach(card => {
                    card.classList.add('matched');
                    card.removeEventListener('click', flipCard); // Remove o listener de clique
                });
                resetFlippedCards();
            }

            /**
             * Vira as cartas que não formam um par de volta.
             */
            function unflipCards() {
                flippedCards.forEach(card => {
                    card.classList.remove('flipped');
                });
                resetFlippedCards();
            }

            /**
             * Reseta o array de cartas viradas e desbloqueia o tabuleiro.
             */
            function resetFlippedCards() {
                flippedCards = [];
                lockBoard = false;
            }

            /**
             * Atualiza os displays de movimentos e pares encontrados.
             */
            function updateDisplay() {
                movesDisplay.textContent = totalMoves;
                matchesDisplay.textContent = matchedPairs;
            }

            /**
             * Atualiza o display do cronômetro.
             */
            function updateTimerDisplay() {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                // Substitui template literal por concatenação de strings
                timerDisplay.textContent = minutes.toString().padStart(2, '0') + ':' + remainingSeconds.toString().padStart(2, '0');
            }

            /**
             * Inicia o cronômetro.
             */
            function startTimer() {
                timerInterval = setInterval(() => {
                    seconds++;
                    updateTimerDisplay();
                }, 1000);
            }

            /**
             * Exibe a tela de resultados.
             */
            function showResultsScreen() {
                gameScreen.style.display = 'none';
                resultsScreen.style.display = 'flex';

                finalStudentName.textContent = studentName;
                finalClass.textContent = studentClass;
                finalTime.textContent = timerDisplay.textContent;
                finalMoves.textContent = totalMoves;
            }

            /**
             * Lida com o início do jogo a partir da tela de início.
             */
            function handleStartGame() {
                studentName = studentNameInput.value.trim();
                studentClass = classSelect.value;

                if (studentName === '' || studentClass === '') {
                    showMessageBox('Por favor, preencha seu nome e selecione sua turma para começar.');
                    return;
                }

                startScreen.style.display = 'none';
                gameScreen.style.display = 'flex';
                initializeGame();
                startTimer();
            }

            /**
             * Lida com o reinício do jogo (botão dentro do jogo).
             */
            function handleResetGame() {
                clearInterval(timerInterval); // Para o cronômetro
                gameScreen.style.display = 'none';
                startScreen.style.display = 'flex';
                studentNameInput.value = ''; // Limpa o nome
                classSelect.value = ''; // Reseta a turma
                // Não chame initializeGame aqui, pois a tela inicial será mostrada
            }

            /**
             * Lida com o botão "Jogar Novamente" na tela de resultados.
             */
            function handlePlayAgain() {
                resultsScreen.style.display = 'none';
                startScreen.style.display = 'flex';
                studentNameInput.value = ''; // Limpa o nome
                classSelect.value = ''; // Reseta a turma
                // Não chame initializeGame aqui, pois a tela inicial será mostrada
            }

            // Adiciona um ouvinte de evento para converter o texto do input para maiúsculas
            studentNameInput.addEventListener('input', (event) => {
                event.target.value = event.target.value.toUpperCase();
            });


            // Adiciona ouvintes de evento aos botões
            startGameButton.addEventListener('click', handleStartGame);
            resetButton.addEventListener('click', handleResetGame);
            playAgainButton.addEventListener('click', handlePlayAgain);

            // Inicializa o jogo mostrando a tela de início
            window.onload = () => {
                startScreen.style.display = 'flex';
                gameScreen.style.display = 'none';
                resultsScreen.style.display = 'none';
            };
        </script>
    </body>
    </html>
  `;

  return (
    <div className="flex flex-col items-center justify-center min-h-screen bg-gray-900 p-4">
      {/* Botão de Voltar para a página principal */}
      <button
        onClick={onBackClick}
        className="absolute top-4 left-4 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200 z-50"
      >
        &larr; Voltar
      </button>
      {/* Iframe para renderizar o conteúdo HTML do jogo */}
      <iframe
        srcDoc={memoryGameHtmlContent}
        title="Jogo da Memória"
        className="w-full h-screen border-none rounded-lg shadow-xl"
      ></iframe>
    </div>
  );
}

// Componente App principal que gerencia a navegação entre as páginas
function App() {
  const [currentPage, setCurrentPage] = useState('home'); // 'home', 'gameSelection', 'memoryGame'

  // Usamos useCallback para memoizar as funções de navegação
  const navigateTo = useCallback((page) => {
    setCurrentPage(page);
  }, []); // Dependências vazias, pois setCurrentPage é estável

  const handleMathClick = useCallback(() => {
    console.log('Conexões Matemáticas clicked'); // Placeholder para futuro jogo de matemática
  }, []);

  const handleGamesClick = useCallback(() => {
    navigateTo('gameSelection');
  }, [navigateTo]); // Depende de navigateTo

  const handleMemoryGameBackClick = useCallback(() => {
    navigateTo('gameSelection');
  }, [navigateTo]); // Depende de navigateTo

  const handleGameSelectionClose = useCallback(() => {
    navigateTo('home');
  }, [navigateTo]); // Depende de navigateTo

  return (
    <>
      {currentPage === 'home' && (
        <LinkBioPage
          onMathClick={handleMathClick}
          onGamesClick={handleGamesClick}
        />
      )}
      {currentPage === 'gameSelection' && (
        <GameSelectionPopup
          onSelectGame={navigateTo}
          onClose={handleGameSelectionClose}
        />
      )}
      {currentPage === 'memoryGame' && (
        <MemoryGamePage onBackClick={handleMemoryGameBackClick} />
      )}
    </>
  );
}

export default App;
